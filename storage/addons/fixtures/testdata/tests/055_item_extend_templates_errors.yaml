- name: WHEN loader find several templates with same name parser MUST fail with error
  method: GET
  path: /gonkex/process
  request: |
     names: ["file1", "file2"]
     fs:
        file1: |
           templates:
             baseTpl:
               f1: tplVal1
           collections:
             table1:
               - f3: value3
        file2: |
           templates:
             baseTpl:
               f2: tplVal2
           collections:
             table1:
               - f3: value3
  response:
    200: |-
       error: parsing file for fixture 'file2': parsing template 'baseTpl': duplicate template name

- name: WHEN file from 'inherits' not exists loader MUST fail with error
  method: GET
  path: /gonkex/process
  request: |
     names: ["file1"]
     fs:
        file1: |
           inherits:
             - file2
           collections:
             table1:
               - $extend: baseTpl
                 f3: value3
               - $extend: ref3
                 f3: value33

  response:
    200: |-
       error: parsing file for fixture 'file1': file not found

- name: WHEN template extend unknown template loader MUST fail with error
  method: GET
  path: /gonkex/process
  request: |
     names: ["file1"]
     fs:
        file1: |
           templates:
             baseTpl:
               f1: tplVal1
             ref3:
               $extend: wrongTpl
               f2: tplVal2
  response:
    200: |-
       error: parsing file for fixture 'file1': parsing template 'ref3': undefined reference 'wrongTpl'

- name: WHEN template has $extend with non-string value loader MUST fail with error
  method: GET
  path: /gonkex/process
  request: |
     names: ["file1"]
     fs:
        file1: |
           templates:
             baseTpl:
               f1: tplVal1
             ref3:
               $extend: {}
               f2: tplVal2
  response:
    200: |-
       error: parsing file for fixture 'file1': parsing template 'ref3': key '$extend' has non-string value 'map[]'

- name: WHEN template consists wrong type parser MUST fail with error
  method: GET
  path: /gonkex/process
  request: |
     names: ["file1"]
     fs:
        file1: |
           templates:
             baseTpl:
               f1: tplVal1
             otherTpl: []
  response:
    200: |-
       error: parsing file for fixture 'file1': parsing template 'otherTpl': map expected, found value with type '[]interface {}'
